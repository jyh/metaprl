#
# Standard theory
#
Theory($(MPFILES))

#
# Documentation
#
LocalTeXGeneratedFiles(theory.tex theory-body.tex)
TheoryDocument(theory, $(PRINT_THEORIES))

#
# Try to figure out if we have the MathTimes fonts.
# For now the check is really simple, but we may want
# to do something smarter.
#
static. =
    print(--- Checking for MathTimes... )
    MATHTIMES_ENABLED = $(file-exists /usr/share/texmf/fonts/type1/times)
    if $(MATHTIMES_ENABLED)
        println($'(enabled)')
    else
        println($'(disabled)')

if $(MATHTIMES_ENABLED)
    BOOK = book3
    export
else
    BOOK = book2
    export

LaTeXDocumentInstall(tex doc, $(DOCDIR), ocaml-book, $(BOOK), theory-body)

watch.ps: $(BOOK).ps
    cp $< tmp.ps
    mv tmp.ps $@

watch.pdf: $(BOOK).pdf
    cp $< tmp.ps
    mv tmp.ps $@

#
# Clean up
#
clean:
    $(CLEAN) theory.tex theory-body.tex theory_print.ml

all: theory$(LIB_SUFFIX)
